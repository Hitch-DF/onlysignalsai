{% extends 'base.html.twig' %}

{% block title %}OnlySignals - {{ 'Vos Signaux de Trading en Temps RÃ©el'|trans }}{% endblock %}

{% block stylesheets %}
	{{ parent() }}
{% endblock %}

{% block body %}
	<div class="d-flex">
		<main class="flex-grow-1">
		<header class="border-bottom py-3 px-4 d-flex justify-content-between align-items-center bg-card">
			<h1 class="h4 mb-0 text-light">OnlySignals</h1>

			<div class="d-flex align-items-center gap-3">
				<form action="{{ path('switch_locale') }}" method="post" class="d-inline">
					<select name="locale" onchange="this.form.submit()" class="form-select form-select-sm">
						<option value="en" {% if app.request.locale == 'en' %}selected{% endif %}>ðŸ‡¬ðŸ‡§</option>
						<option value="fr" {% if app.request.locale == 'fr' %}selected{% endif %}>ðŸ‡«ðŸ‡·</option>
					</select>
				</form>


				<a href="{{ path('app_login') }}" class="btn btn-secondary d-inline-flex align-items-center">
					{{ 'Login'|trans }}
				</a>
				<a href="{{ path('app_register') }}" class="btn btn-primary d-inline-flex align-items-center">
					{{ 'Sign Up'|trans }}
				</a>
			</div>
		</header>



			{% include '_partial/connected_ai.html.twig' %}

			{% if signals is empty %}
				<div class="container py-5 text-center">
					<i class="bi bi-lock-fill fs-1 mb-3 text-muted"></i>
					<p class="lead text-muted">{{ 'Vous devez Ãªtre abonnÃ© pour voir les signaux actifs'|trans }}.</p>
					<a href="{{ path('subscription_plans') }}" class="btn btn-primary">{{ 'Voir les offres'|trans }}</a>
				</div>
			{% else %}
				<div class="row m-0 py-3">
					{% for signal in signals %}
						<div class="col-md-4 mb-4">
							<div class="card border bg-card text-light shadow-sm h-100 hover-shadow transition">
								<div class="card-body pb-2">
									<div class="d-flex justify-content-between align-items-center mb-2">
										<h5 class="fw-bold mb-0">{{ signal.symbol }}</h5>
										<div class="badge rounded-pill text-white px-2 py-1 {{ signal.signalType == 'Buy' ? 'bg-success' : 'bg-danger' }}">
											<i class="bi {{ signal.signalType == 'Buy' ? 'bi-graph-up-arrow' : 'bi-graph-down-arrow' }} me-1"></i>
											{{ signal.signalType }}
										</div>
									</div>
									<div class="text-muted small mb-3">
										<i class="bi bi-clock me-1"></i>
										{{ signal.createdAt|date('d/m/Y H:i') }} â€¢ {{ signal.timeFrame|default('N/A') }}
									</div>
									<ul class="list-unstyled small mb-0">
										<li class="d-flex justify-content-between">
											<span class="text-muted">{{"Entry Price"|trans}}:</span>
											<span class="fw-semibold">${{ signal.entryPrice|number_format(2, '.', ',') }}</span>
										</li>
										{% if signal.exitPrice is not null %}
											<li class="d-flex justify-content-between">
												<span class="text-muted">{{"Exit Price"|trans}}:</span>
												<span class="fw-semibold">${{ signal.exitPrice|number_format(2, '.', ',') }}</span>
											</li>
										{% endif %}
										{% if signal.pips is not null %}
											<li class="d-flex justify-content-between">
												<span class="text-muted">{{"Pips"|trans}}:</span>
												<span class="fw-semibold">{{ signal.pips }}</span>
											</li>
										{% endif %}
										<li class="d-flex justify-content-between">
											<span class="text-muted">{{"Category"|trans}}:</span>
											<span class="badge bg-secondary text-light">{{ signal.category }}</span>
										</li>
									</ul>
								</div>
								<div class="card-footer border-0 pt-0 bg-transparent">
									<a href="https://www.tradingview.com/chart/?symbol={{ signal.symbol }}" target="_blank"
										class="btn btn-outline-secondary btn-sm w-100 d-flex align-items-center justify-content-center gap-2">
										<i class="bi bi-bar-chart-line"></i> {{"View Chart"|trans}}
									</a>
								</div>
							</div>
						</div>
						{% if loop.index is divisible by(3) %}</div><div class="row m-0 py-3">{% endif %}
					{% endfor %}
				</div>
			{% endif %}

			<div class="container py-4">
				<div class="row g-3 mb-4">
					<div class="d-flex justify-content-between align-items-center mb-4">
						<div class="d-flex gap-2">
							<a href="{{ path('simulate_signal') }}" class="btn btn-outline-secondary d-none d-sm-inline-flex">
								<i class="bi bi-plus-square me-2"></i>
								{{ 'Simulate Signal'|trans }}
							</a>
						</div>
					</div>
					{% include "signal/history.html.twig" %}
				</div>
			</div>
		</main>
	</div>
{% endblock %}

{% block javascripts %}
	{{ parent() }}
{% endblock %}
